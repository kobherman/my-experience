Сеть с архитектурой **cWGAN-GP**, окрашивающая бесцветные изображения.

# Датасет
## Изначальный Датасет
Изображения датасета **MIRFLICKR25k** разбитые на Lab каналы в виде `.npy` файлов взяты с: [Kaggle](https://www.kaggle.com/datasets/shravankumar9892/image-colorization).\
Теги к изображениям в виде папки '.txt' файлов со всеми тегами, разбитыми началом новой строки, для каждого отдельного изображения, взяты из оригинального датасета: [MIRFLICKR25k](https://press.liacs.nl/mirflickr/mirdownload.html)

## Дополнение
В рамках масштабирования сети вместо 25 тысяч изображений с официального сайта были взяты 1 млн (архивы есть на оригинальном сайте датасета [MIRFLICKR25k](https://press.liacs.nl/mirflickr/mirdownload.html)).\
В файле `imgs_setup.ipynb` имплементирована их обработка к виду, схожему с предыдущим. 1 млн. изображений разбит на 100 `.npy` файлов по 10,000 изображений. Теги сохранены одним файлом, но также разбиты на группы по 10,000 вдоль первой размерности матрицы (теги не весят много, поэтому таким образом можно избежать создание большого количества файлов)

# Conditional
В качестве дополнительных условий при генерации цветных (ab) каналов используется канал L и первые ~~8 тегов~~ 20 токенов из тегов изображения.

# Токенизация тегов
## Прошлый подход
Обработка тегов осуществляется в файле `tags setup.ipynb`.\
Порядок:
 1. Теги всех изображений записываются в один общий файл (теги одного изображения разделены пробелом, разных - началом строки)
 2. Из файла убираются иероглифы, небуквенные символы
 3. Оставшиеся теги токенизируются (весь тег одной строкой без пробелов - один индекс) и посредством словаря порядок записывается в файл `words_to_inds.npy`.\
Ко всем токенам добавляется "токен отсутсвия тега" - пустая строка: `''`, - причём, строго с индексом 0 (выполняет функцию `<pad>` токена). `<unk>` токен не предусмотрен, т.к. словарь составлен по всем токенам из датасета.
 4. При инизиализации переменной датасета в программе с сетью берутся первые `tag_num=8` тегов

## Новый подход
Теперь используется токенизатор `o200k_base` из библиотеки `tiktoken` (с добавлением `<|pad|>` символа). При обработке беруться первые 20 токенов.\
Смена токенизатора связана с большим количеством тегов, которые за все 1 млн. изображений встречаются илшь единожды. Тем не менее, в случае данного токенизатора имеются токены, не встречающиеся ни разу (их больше половины).\
Подробную статистику по токенам или изображениям (распределения значений каналов) можно посмотреть в файле `data_stats.md`

# Результаты
Генерируемые окраски после ~16-ти эпох обучения на 1 млн. изображений (или же 6 запусков по 16 эпох на 200,000 изображений (1/5 датасета) ~= 95 эпох)\
(Отобран хороший батч)

![result images](imgs/result_collage.png)
